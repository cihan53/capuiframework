{"version":3,"sources":["../../../../src/Lib/CAP/Data/Ajax.js"],"names":["superagentPromise","_superagent","superagent","global","Promise","Ajax","running","tokenPlugin","req","handleErrors","err","res","responseBody","body","init","queues","_running","queue","name","queueName","unqueue","end","fn","abort","get","url","params","fullUrl","API_ROOT_URL","startsWith","Request","query","use","then","post","type","postMultiPart","postForm","postJson","on","Object","keys","forEach","key","File","attach","field","retry","_type","_id","_uniqueIdGenerator","_Request","oldEnd","prototype","bind","value","currentId"],"mappings":"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","sourcesContent":["/**\r\n * Module dependencies.\r\n */\r\n\r\nimport superagentPromise from \"superagent-promise\";\r\nimport _superagent from \"superagent\";\r\n\r\nconst superagent = superagentPromise(_superagent, global.Promise);\r\n\r\n\r\n/**\r\n * Extends the built-in dependency.\r\n */\r\n\r\nexport default class Ajax {\r\n\r\n    static currentId = 0;\r\n    running = null;\r\n    tokenPlugin = (req) => {\r\n\r\n    }\r\n\r\n    handleErrors = (err, res) => {\r\n\r\n    }\r\n\r\n    responseBody = (res) => {\r\n        return res.body;\r\n    }\r\n\r\n    constructor() {\r\n        this._type = 'ajax';\r\n        this._id = Ajax._uniqueIdGenerator();\r\n        this._Request = superagent;\r\n        this.oldEnd = superagent.prototype.end;\r\n        this.init = this.init.bind(this);\r\n\r\n    }\r\n\r\n     static _uniqueIdGenerator=()=>{\r\n        return ++this.currentId;\r\n    }\r\n\r\n    get Request() {\r\n        return this._Request;\r\n    }\r\n\r\n    set Request(value) {\r\n        this._Request = value;\r\n    }\r\n\r\n    init = () => {\r\n\r\n    };\r\n\r\n    /**\r\n     * Queues.\r\n     */\r\n    queues = {};\r\n    _running = {};\r\n\r\n\r\n    queue = (name) => {\r\n        this.queueName = name;\r\n        return this;\r\n    };\r\n\r\n\r\n    unqueue = (name) => {\r\n\r\n    }\r\n\r\n\r\n    get id() {\r\n        return this._id;\r\n    }\r\n\r\n    set id(value) {\r\n        this._id = value;\r\n    }\r\n\r\n\r\n    get running() {\r\n        return this._running;\r\n    }\r\n\r\n    set running(value) {\r\n        this._running = value;\r\n    }\r\n\r\n    end = (fn) => {\r\n\r\n    };\r\n    /**\r\n     * iÅŸlemi kes\r\n     */\r\n    abort = () => {\r\n        this._running.abort();\r\n    }\r\n\r\n\r\n    get = (url, params = {}) => {\r\n\r\n        var fullUrl = `${API_ROOT_URL}${url}`;\r\n        if (url.startsWith(\"http://\") || url.startsWith(\"https://\") || url.startsWith(\"//\")) {\r\n            fullUrl = url;\r\n        }\r\n\r\n        this._running = this.Request.get(fullUrl).query(params);\r\n        return this._running\r\n            .use(this.tokenPlugin)\r\n            .end(this.handleErrors)\r\n            .then(this.responseBody);\r\n\r\n    }\r\n\r\n    post = (url, body, type = 'post') => {\r\n        if (type == 'multipart') {\r\n            return this.postMultiPart(url, body);\r\n        } else if (type == 'formdata') {\r\n            return this.postForm(url, body);\r\n        } else {\r\n            return this.postJson(url, body);\r\n        }\r\n    }\r\n\r\n    postJson = (url, body) => {\r\n        var fullUrl = `${API_ROOT_URL}${url}`;\r\n        if (url.startsWith(\"http://\") && url.startsWith(\"https://\")) {\r\n            fullUrl = url;\r\n        }\r\n        this._running = this.Request.post(fullUrl, body);\r\n\r\n        return this._running\r\n            .use(this.tokenPlugin)\r\n            .on(\"error\", this.handleErrors)\r\n            .end(this.handleErrors)\r\n            .then(this.responseBody);\r\n    }\r\n\r\n    postForm = (url, body) => {\r\n\r\n        var fullUrl = `${API_ROOT_URL}${url}`;\r\n        if (url.startsWith(\"http://\") && url.startsWith(\"https://\")) {\r\n            fullUrl = url;\r\n        }\r\n\r\n        this._running = this.Request.post(fullUrl, body);\r\n        return this._running\r\n            .use(this.tokenPlugin)\r\n            .on(\"error\", this.handleErrors)\r\n            .end(this.handleErrors)\r\n            .then(this.responseBody);\r\n    }\r\n\r\n    postMultiPart = (url, body) => {\r\n        this._running = this.Request.post(`${API_ROOT_URL}${url}`);\r\n\r\n        Object.keys(body).forEach((key)=>{\r\n            if ((body[key] instanceof File)) {\r\n                this._running.attach(key, body[key]);\r\n            } else {\r\n                this._running.field(key, body[key]);\r\n            }\r\n\r\n        });\r\n\r\n        return this._running.use(this.tokenPlugin)\r\n            .retry(0)\r\n            .on(\"error\", this.handleErrors)\r\n            .end(this.handleErrors)\r\n            .then(this.responseBody);\r\n\r\n    }\r\n\r\n}"],"file":"Ajax.js"}