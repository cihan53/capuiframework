var _class,_temp;function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _possibleConstructorReturn(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:_assertThisInitialized(a)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _extends(){return _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_extends.apply(this,arguments)}import React from"react";import{observer}from"mobx-react/index";import PropTypes from"prop-types";import BootstrapTable from"react-bootstrap-table-next";import paginationFactory from"react-bootstrap-table2-paginator";import overlayFactory from"react-bootstrap-table2-overlay";import filterFactory from"react-bootstrap-table2-filter";import cellEditFactory from"react-bootstrap-table2-editor";import StoreManager from"../../StoreManager";import Panel from"../Panel/Panel";import Utils from"../Utils/Utils";import ContextMenu from"./ContextMenu";import{ExportCSVButton}from"./ToolKit";const defaultSorted=[{dataField:"name",order:"desc"}],EmptyTableDataIndication=()=>React.createElement("div",null,React.createElement("p",null,Utils.__t("Kay\u0131t yok"))),Table=({_ref:a,store:b,data:c,columns:d,page:e,sizePerPage:f,onTableChange:g,tableContextMenuRef:h,otherprops:i,cellEdit:k=null,totalSize:j,keyField:l="id"})=>{let m={tabIndexCell:!0,remote:!0,keyField:l,data:c,columns:d,defaultSorted:defaultSorted,filter:filterFactory(),onTableChange:g,overlay:overlayFactory({spinner:!0,background:"rgba(192,192,192,0.3)"}),noDataIndication:()=>React.createElement(EmptyTableDataIndication,null)};null!=k&&(m.cellEdit=cellEditFactory(k));return i.pagination&&(m.pagination=paginationFactory({withFirstAndLast:!0,page:e,sizePerPage:f,totalSize:j,showTotal:!0,pageStartIndex:1,paginationSize:10,firstPageText:Utils.__t("\u0130lk Sayfa"),prePageText:Utils.__t("\xD6nceki Sayfa"),nextPageText:Utils.__t("Sonraki Sayfa"),lastPageText:Utils.__t("Son Sayfa"),firstPageTitle:Utils.__t("\u0130lk Sayfa"),prePageTitle:Utils.__t("\xD6nceki Sayfa"),nextPageTitle:Utils.__t("Sonraki Sayfa"),lastPageTitle:Utils.__t("Son Sayfa"),paginationTotalRenderer:(a,b,c)=>React.createElement("span",{className:"react-bootstrap-table-pagination-total"}," ",Utils.__t("Toplam Kay\u0131t: :size",{size:c}))})),delete i.pagination,React.createElement(React.Fragment,null,i.hasOwnProperty("buttons")?React.createElement(ExportCSVButton,{data:b.data,columns:d}):void 0,React.createElement(BootstrapTable,_extends({ref:a},m.baseProps,m,i)),React.createElement(ContextMenu,{container:i.id,ref:h,clickItem:i.onContextMenuClickItem||void 0}))};Table.propTypes={data:PropTypes.array.isRequired,page:PropTypes.number.isRequired,totalSize:PropTypes.number.isRequired,sizePerPage:PropTypes.number.isRequired,onTableChange:PropTypes.func.isRequired};let Grid=observer(_class=(_temp=function(a){function b(a){var c;return _classCallCheck(this,b),c=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a)),c.store=null,c.data=null,c.limit=50,c.autoload=!0,c.columns=[],c.config={xtype:"grid"},c.handleTableChange=(a,{page:b,sizePerPage:d,sortField:e,sortOrder:f,filters:g,data:h,cellEdit:i})=>{if("cellEdit"!=a){let a=(b-1)*d;a=0>a?0:a,c.store.load({page:b,start:a,size:d,sortField:e,sortOrder:f,filters:g})}else c.props.config.hasOwnProperty("cellEdit")&&c.props.config.cellEdit.hasOwnProperty("afterSaveCell")&&c.props.config.cellEdit.afterSaveCell(h,i)},c._store=null,c.handleTableChange=c.handleTableChange.bind(_assertThisInitialized(c)),c.init=c.init.bind(_assertThisInitialized(c)),c.configSet=c.configSet.bind(_assertThisInitialized(c)),c.key=Utils.ShortId.generate(),c.xgrid=React.createRef(),c.tableContextMenu=React.createRef(),c.configSet(),c.init(),c}return _inherits(b,a),_createClass(b,[{key:"init",value:function init(a=""){if(this.props.config.store){if("string"==typeof this.props.config.store)this._store=StoreManager.get(this.props.config.store)||null;else{let a=this.props.config.store.name,b=this.props.config.store.baseParams||null,c=this.props.config.store.defaultSort||null;this._store=StoreManager.get(a)||null,this.store&&b&&this.store.setParameters(b),this.store&&c&&this.store.setDefaultSortDir(c.dir,c.sort)}if(!this.store)throw new Error("Undefined Store");this.autoload=!this.props.config.hasOwnProperty("autoload")||this.props.config.autoload}else if(this.props.config.data)this.data=this.props.config.data||[],this.autoload=!1;else throw new Error("Undefined Store")}},{key:"configSet",value:function configSet(){this.config=Object.assign(this.config,this.props.config),this.columns=this.props.config.columns||[]}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(a){return this.props!=a&&this.init("propsChange"),this.props!=a}},{key:"UNSAFE_componentWillMount",value:function UNSAFE_componentWillMount(){this.props.config.hasOwnProperty("onBeforeRender")&&this.props.config.onBeforeRender(this);this.autoload&&this.store.load({page:0,start:0,size:this.limit})}},{key:"UNSAFE_componentWillUpdate",value:function UNSAFE_componentWillUpdate(){this.props.config.hasOwnProperty("onBeforeRender")&&this.props.config.onBeforeRender(this)}},{key:"componentDidCatch",value:function componentDidCatch(){}},{key:"render",value:function render(){const{totalCount:a=0,limit:b=this.limit,currentPage:c=0}=this.store||{totalCount:0,limit:this.limit,page:0},d=this.store?this.store.data:this.data;let e={},f=this.store?this.store.keyField:"id";this.props.config.hasOwnProperty("keyField")&&(f=this.props.config.keyField);let g=null;this.props.config.hasOwnProperty("cellEdit")&&(g=this.props.config.cellEdit);const h=["store","keyField","data","currentPage","sizePerPage","columns","totalSize","onTableChange","panelOptions","xtype","cellEdit","tableContextMenuRef"],i=Object.keys(this.props.config);for(const a in i){const b=i[a];-1==h.indexOf(b)&&(e[b]=this.props.config[b])}let j=React.createElement(Table,{_ref:this.xgrid,key:this.key+"-gridtable",keyField:f,data:d,page:c,sizePerPage:b,columns:this.columns,totalSize:a,otherprops:e,onTableChange:this.handleTableChange,cellEdit:g,tableContextMenuRef:this.tableContextMenu,store:this.store});return"gridpanel"==this.config.xtype.toLocaleLowerCase()?React.createElement(Panel,{_key:this.key+"-gridPanel",items:[j],config:this.props.config.panelOptions}):React.createElement(React.Fragment,null,j)}},{key:"store",get:function(){return this._store},set:function(a){this._store=a}}]),b}(React.Component),_temp))||_class;export{Grid as default};Grid.propTypes={keyField:PropTypes.string.isRequired,config:PropTypes.any.isRequired,data:PropTypes.array,columns:PropTypes.array.isRequired,store:PropTypes.any},Grid.defaultProps={config:{xtype:"grid"},columns:[],data:null};